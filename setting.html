<!DOCTYPE html>  <html> <head>   <title>setting.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="rocco.css" /> </head> <body> <div id="navbar">     <h3>Google News - Chrome App<em></em></h3>   </div>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">           <a class="source" href="index.html">Index</a>                                           <a class="source" href="google.html">                 google.js               </a>                                           <a class="source" href="foreground-setup.html">                 foreground-setup.js               </a>                                           <a class="source" href="background-setup.html">                 background-setup.js               </a>                                           <a class="source" href="setup.html">                 setup.js               </a>                                           <a class="source" href="background.html">                 background.js               </a>                                           <a class="source" href="app.html">                 app.js               </a>                                           <a class="source" href="article.html">                 article.js               </a>                                           <a class="source" href="displayed-articles.html">                 displayed-articles.js               </a>                                           <a class="source" href="search.html">                 search.js               </a>                                           <a class="source" href="setting.html">                 setting.js               </a>                                           <a class="source" href="article-view.html">                 article-view.js               </a>                                           <a class="source" href="category-view.html">                 category-view.js               </a>                                           <a class="source" href="fullscreen-view.html">                 fullscreen-view.js               </a>                                           <a class="source" href="intent-view.html">                 intent-view.js               </a>                                           <a class="source" href="notifications-view.html">                 notifications-view.js               </a>                                           <a class="source" href="search-results-view.html">                 search-results-view.js               </a>                                           <a class="source" href="search-view.html">                 search-view.js               </a>                                           <a class="source" href="settings-view.html">                 settings-view.js               </a>                                           <a class="source" href="window-view.html">                 window-view.js               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               setting.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="cm">/*global App */</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <h3>Authors</h3>

<p>Jamie Dyer <a href="http://kernowsoul.com">http://kernowsoul.com</a></p>

<h3>Last changed</h3>

<p>2012-06-23</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <h2>Overview</h2>

<p>Stores the settings used throughout the application. Settings are stored in Chrome sync storage which
handles syncing data across multiple computers. If the user is logged into another computer all their
settings will be preserved.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">App</span><span class="p">.</span><span class="nx">Settings</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Model</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <h3> initialize</h3>

<p>Setup the sync store and add a listener so we know when data has been changed</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">syncStore</span> <span class="o">=</span> <span class="nx">chrome</span><span class="p">.</span><span class="nx">storage</span><span class="p">.</span><span class="nx">sync</span><span class="p">;</span>
    <span class="nx">chrome</span><span class="p">.</span><span class="nx">storage</span><span class="p">.</span><span class="nx">onChanged</span><span class="p">.</span><span class="nx">addListener</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">changes</span><span class="p">,</span> <span class="nx">namespace</span><span class="p">){</span> <span class="nx">self</span><span class="p">.</span><span class="nx">onSyncDataChange</span><span class="p">(</span><span class="nx">changes</span><span class="p">,</span> <span class="nx">namespace</span><span class="p">);</span> <span class="p">});</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <h3>addCategory(category)</h3>

<p>Accepts a category string
Adds a category to the categories array and saves it to the sync store</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">addCategory</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">category</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">categories</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;categories&#39;</span><span class="p">);</span>
    <span class="nx">categories</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">category</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Save the categories and call uniq on the array to make sure there are no duplicates</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">this</span><span class="p">.</span><span class="nx">save</span><span class="p">({</span> <span class="s2">&quot;categories&quot;</span> <span class="o">:</span> <span class="nx">_</span><span class="p">.</span><span class="nx">uniq</span><span class="p">(</span><span class="nx">categories</span><span class="p">)</span> <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>When a category is added we need need to load up new articles from the category</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">App</span><span class="p">.</span><span class="nx">articles</span><span class="p">.</span><span class="nx">getFromFeed</span><span class="p">(</span><span class="nx">App</span><span class="p">.</span><span class="nx">googleFeed</span><span class="p">,</span> <span class="nx">category</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>Trigger the <code>categoryAdded</code> event</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;categoryAdded&quot;</span><span class="p">,</span> <span class="nx">category</span><span class="p">);</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <h3> removeCategory(category)</h3>

<p>Accepts a category string
Removes a category from the categories array and saves it to the sync store</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">removeCategory</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">category</span><span class="p">){</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>Remove the category from the array and save it</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">categories</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">without</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;categories&#39;</span><span class="p">),</span> <span class="nx">category</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">save</span><span class="p">({</span> <span class="s2">&quot;categories&quot;</span> <span class="o">:</span> <span class="nx">categories</span> <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>remove the articles from the category that is no longer displayed</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">App</span><span class="p">.</span><span class="nx">articles</span><span class="p">.</span><span class="nx">removeWithCategory</span><span class="p">(</span><span class="nx">category</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>Trigger the <code>categoryRemoved</code> event</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;categoryRemoved&quot;</span><span class="p">,</span> <span class="nx">category</span><span class="p">);</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <h3>saveOpenArticleId(id)</h3>

<p>Accepts an id string
Saves the id of the currently open article so that the app's state can be restored</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">saveOpenArticleId</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">save</span><span class="p">({</span> <span class="s2">&quot;openArticleId&quot;</span> <span class="o">:</span> <span class="nx">id</span> <span class="p">});</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <h2>saveCurrentFilterCategory(category)</h2>

<p>Accepts a category string
Saves the current category filter and raises the <code>filterCategoryChanged</code> event</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">saveCurrentFilterCategory</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">category</span><span class="p">){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">save</span><span class="p">({</span> <span class="s2">&quot;filterCategory&quot;</span><span class="o">:</span> <span class="nx">category</span> <span class="p">});</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">&#39;filterCategoryChanged&#39;</span><span class="p">,</span> <span class="nx">category</span><span class="p">);</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <h3>changeLanguage(languageCode)</h3>

<p>Accepts a languageCode string
Changes the language of the Google news feeds to load and saves to the sync store</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">changeLanguage</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">languageCode</span><span class="p">){</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>Get the name of the language from the code</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">App</span><span class="p">.</span><span class="nx">supportedLanguages</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">){</span> <span class="k">return</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">code</span> <span class="o">==</span> <span class="nx">languageCode</span><span class="p">;</span> <span class="p">}).</span><span class="nx">name</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">feedLanguage</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;code&quot;</span><span class="o">:</span> <span class="nx">languageCode</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="nx">name</span> <span class="p">};</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">save</span><span class="p">({</span> <span class="s2">&quot;feedLanguage&quot;</span><span class="o">:</span> <span class="nx">feedLanguage</span> <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>Remove all articles as they are no longer needed</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">App</span><span class="p">.</span><span class="nx">articles</span><span class="p">.</span><span class="nx">removeAll</span><span class="p">();</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>Download articles in the new language</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">App</span><span class="p">.</span><span class="nx">articles</span><span class="p">.</span><span class="nx">getFromFeed</span><span class="p">(</span><span class="nx">App</span><span class="p">.</span><span class="nx">googleFeed</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>Trigger the <code>languageChanged</code> event</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;languageChanged&quot;</span><span class="p">,</span> <span class="nx">feedLanguage</span><span class="p">);</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <h2>getFilterCategory</h2>

<p>Returns the current filter category or 'allStories' if none is stored</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">getFilterCategory</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">category</span> <span class="o">=</span> <span class="nx">App</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;filterCategory&#39;</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">category</span> <span class="o">?</span> <span class="nx">category</span> <span class="o">:</span> <span class="s1">&#39;allStories&#39;</span><span class="p">;</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <h3>onSyncDataChange(changes, namespace)</h3>

<p>Accepts a changes object and a namespace sting
Handles sync events raised by Chrome sync storage and updates the models data accordingly</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">onSyncDataChange</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">changes</span><span class="p">,</span> <span class="nx">namespace</span><span class="p">){</span></pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>We are only interested in sync events</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">namespace</span> <span class="o">==</span> <span class="s1">&#39;sync&#39;</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>set the new values into the backbone model</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>categories</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span><span class="p">(</span><span class="nx">changes</span><span class="p">.</span><span class="nx">categories</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;categories&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">changes</span><span class="p">.</span><span class="nx">categories</span><span class="p">.</span><span class="nx">newValue</span><span class="p">){</span></pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>set the changes but no need to save them as they are already in the sync storage</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">({</span> <span class="s1">&#39;categories&#39;</span><span class="o">:</span> <span class="nx">changes</span><span class="p">.</span><span class="nx">categories</span><span class="p">.</span><span class="nx">newValue</span> <span class="p">});</span>
      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <p>feedLanguage</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span><span class="p">(</span><span class="nx">changes</span><span class="p">.</span><span class="nx">feedLanguage</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;feedLanguage&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">changes</span><span class="p">.</span><span class="nx">feedLanguage</span><span class="p">.</span><span class="nx">newValue</span><span class="p">){</span></pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p>set the changes but no need to save them as they are already in the sync storage</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">({</span> <span class="s1">&#39;feedLanguage&#39;</span><span class="o">:</span> <span class="nx">changes</span><span class="p">.</span><span class="nx">feedLanguage</span><span class="p">.</span><span class="nx">newValue</span> <span class="p">});</span>
      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <p>openArticleId</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span><span class="p">(</span><span class="nx">changes</span><span class="p">.</span><span class="nx">openArticleId</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;openArticleId&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">changes</span><span class="p">.</span><span class="nx">openArticleId</span><span class="p">.</span><span class="nx">newValue</span><span class="p">){</span></pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <p>set the changes but no need to save them as they are already in the sync storage</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">({</span> <span class="s1">&#39;openArticleId&#39;</span><span class="o">:</span> <span class="nx">changes</span><span class="p">.</span><span class="nx">openArticleId</span><span class="p">.</span><span class="nx">newValue</span> <span class="p">});</span>
      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <p>filterCategory</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span><span class="p">(</span><span class="nx">changes</span><span class="p">.</span><span class="nx">filterCategory</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;filterCategory&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">changes</span><span class="p">.</span><span class="nx">filterCategory</span><span class="p">.</span><span class="nx">newValue</span><span class="p">){</span></pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <p>set the changes but no need to save them as they are already in the sync storage</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">({</span> <span class="s1">&#39;filterCategory&#39;</span><span class="o">:</span> <span class="nx">changes</span><span class="p">.</span><span class="nx">filterCategory</span><span class="p">.</span><span class="nx">newValue</span> <span class="p">});</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <h3>sync(method, model, options)</h3>

<p>Accepts a method string, model object, and options object
This function overrides the backbone functions normal sync behavior. As we are using the
Chrome sync storage as our backend we need to read and write data to it when sync is called.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">sync</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">model</span><span class="p">,</span> <span class="nx">options</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

    <span class="k">switch</span> <span class="p">(</span><span class="nx">method</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">case</span> <span class="s2">&quot;read&quot;</span><span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-33">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-33">&#182;</a>               </div>               <p>Get a record from the sync store</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">this</span><span class="p">.</span><span class="nx">syncStore</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">items</span><span class="p">){</span>
          <span class="k">if</span><span class="p">(</span><span class="nx">chrome</span><span class="p">.</span><span class="nx">extension</span><span class="p">.</span><span class="nx">lastError</span><span class="p">){</span></pre></div>             </td>           </tr>                               <tr id="section-34">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-34">&#182;</a>               </div>               <p>If there was an error pass it to the error callback</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">options</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">chrome</span><span class="p">.</span><span class="nx">extension</span><span class="p">.</span><span class="nx">lastError</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
          <span class="p">}</span><span class="k">else</span><span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-35">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-35">&#182;</a>               </div>               <p>On success store the records in the model</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">self</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">items</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-36">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-36">&#182;</a>               </div>               <p>invoke the success callback</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">options</span><span class="p">.</span><span class="nx">success</span><span class="p">();</span>
          <span class="p">}</span>
        <span class="p">});</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="k">case</span> <span class="s2">&quot;create&quot;</span><span class="o">:</span>
      <span class="k">case</span> <span class="s2">&quot;update&quot;</span><span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-37">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-37">&#182;</a>               </div>               <p>Save data to the sync store</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">this</span><span class="p">.</span><span class="nx">syncStore</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">model</span><span class="p">.</span><span class="nx">attributes</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
          <span class="k">if</span><span class="p">(</span><span class="nx">chrome</span><span class="p">.</span><span class="nx">extension</span><span class="p">.</span><span class="nx">lastError</span><span class="p">){</span></pre></div>             </td>           </tr>                               <tr id="section-38">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-38">&#182;</a>               </div>               <p>If there was an error pass it to the error callback</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">options</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">chrome</span><span class="p">.</span><span class="nx">extension</span><span class="p">.</span><span class="nx">lastError</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
          <span class="p">}</span><span class="k">else</span><span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-39">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-39">&#182;</a>               </div>               <p>invoke the success callback</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">options</span><span class="p">.</span><span class="nx">success</span><span class="p">();</span>
          <span class="p">}</span>
        <span class="p">});</span>
    <span class="p">}</span>
  <span class="p">}</span>

<span class="p">});</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 